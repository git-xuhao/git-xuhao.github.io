<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>shell 输入/输出重定向（四）</title>
    <meta name="description" content="前言原本计划国庆节第一天假期休息一天，但是想想自己还有很多事情没有完成，就立马打开电脑，开始干活了。打算这7天的假期好好整理下之前学的知识和巩固练习，充实每一天，好了入正题，Linux shell脚本基础前面我们在介绍Linux shell脚本的控制流程时，还有一部分内容没讲就是有关here document的内...">

    <link rel="shortcut icon" href="/favicon.ico?" type="image/x-icon">
    <link rel="icon" href="/favicon.ico?" type="image/x-icon">
    <link rel="stylesheet" href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://at.alicdn.com/t/font_8v3czwksspqlg14i.css">
    <link rel="stylesheet" href="/css/main.css ">
    <link rel="canonical" href="http://localhost:4000/linux/shell-script-04">
    <link rel="alternate" type="application/rss+xml" title="XUHAO’S 博客" href="http://localhost:4000/feed.xml ">


    <script>
    // 百度统计代码
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?3e58af9d5d9338b706ad81d79dcedb4c";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
    </script>


    <script>
    // google analytics
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-122974929-1', 'auto');
      ga('send', 'pageview');

    </script>



</head>


  <body>

    <header id="top">
    <div class="wrapper">
        <a href="/" class="brand">XUHAO’S 博客</a>
        <small>Always hungry to keep learning.</small>
        <button id="headerMenu" class="menu"><i class="fa fa-bars"></i></button>
        <nav id="headerNav">
            <ul>
                <li>
                    
                    <a href="/">
                    
                        <i class="fa fa-home"></i>博客
                    </a>
                </li>

                
                    
                    <li>
                        
                        <a href="/archive/">
                        
                            <i class="fa fa-archive"></i>归档
                        </a>
                    </li>
                    
                
                    
                    <li>
                        
                        <a href="/category/">
                        
                            <i class="fa fa-th-list"></i>分类
                        </a>
                    </li>
                    
                
                    
                
                    
                    <li>
                        
                        <a href="/collection/">
                        
                            <i class="fa fa-bookmark"></i>书签
                        </a>
                    </li>
                    
                
                    
                    <li>
                        
                        <a href="/demo/">
                        
                            <i class="fa fa-play"></i>项目
                        </a>
                    </li>
                    
                
                    
                    <li>
                        
                        <a href="/about/">
                        
                            <i class="fa fa-user"></i>关于
                        </a>
                    </li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>
        </nav>
    </div>
</header>


        <div class="page clearfix" post>
    <div class="left">
        <h1>shell 输入/输出重定向（四）</h1>
        <div class="label">

            <div class="label-card">
                <i class="fa fa-calendar"></i>2016-10-01
            </div>

            <div class="label-card">
                
            </div>

            <div class="label-card">
                
            </div>

            <div class="label-card">
            


<!-- <span class="point">•</span> -->
<span class="categories">
  <!-- <i class="fa fa-th-list"></i>
  
    
        <a href="/category/#Shell" title="Category: Shell" rel="category">Shell</a>
    
  
 -->
  <i class="fa "></i>
  
    
        <a href="/category/#Shell" title="Category: Shell" rel="category">Shell</a>
    
  

  <!-- <span class="point">•</span> -->
</span>


            </div>

            <div class="label-card">
            
<!-- <span class="point">•</span> -->
<span class="pageTag">
  <i class="fa fa-tags"></i>
  
    
        <!--a href="/tag/#Shell" title="Tag: Shell" rel="tag">Shell</a-->
        <a href="/tag/#Shell" title="Tag: Shell" rel="tag">Shell</a>
    
  

</span>

            </div>

        </div>
        <hr>
        <article itemscope itemtype="http://schema.org/BlogPosting">
        <h3 id="前言">前言</h3>
<p>原本计划国庆节第一天假期休息一天，但是想想自己还有很多事情没有完成，就立马打开电脑，开始干活了。打算这7天的假期好好整理下之前学的知识和巩固练习，充实每一天，好了入正题，Linux shell脚本基础前面我们在介绍Linux shell脚本的控制流程时，还有一部分内容没讲就是有关here document的内容这里继续，Here Document 是 Shell 中的一种特殊的重定向方式，用来将输入重定向到一个交互式 Shell 脚本或程序。</p>

<p>原文链接请标明： 
<a href="http://xuhaoblog.com/linux/shell-script-04.html">http://xuhaoblog.com/linux/shell-script-04.html</a>
本文出自:【<a href="http://xuhaoblog.com">stromxu</a>的博客】</p>

<hr />

<h3 id="正文">正文</h3>
<p><a href="http://xuhaoblog.com/2016/09/30/linux/shell-script-03.html">接着上一篇继续…</a></p>

<h4 id="1shell-输入输出重定向"><strong>1、Shell 输入/输出重定向</strong></h4>
<h5 id="重定向命令列表如下">重定向命令列表如下：</h5>

<table>
  <thead>
    <tr>
      <th>命令</th>
      <th style="text-align: left">说明</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>command &gt; file</td>
      <td style="text-align: left">将输出重定向到 file。</td>
    </tr>
    <tr>
      <td>command &lt; file</td>
      <td style="text-align: left">将输入重定向到 file。</td>
    </tr>
    <tr>
      <td>command » file</td>
      <td style="text-align: left">将输出以追加的方式重定向到 file。</td>
    </tr>
    <tr>
      <td>n &gt; file</td>
      <td style="text-align: left">将文件描述符为 n 的文件重定向到 file。</td>
    </tr>
    <tr>
      <td>n » file</td>
      <td style="text-align: left">将文件描述符为 n 的文件以追加的方式重定向到 file。</td>
    </tr>
    <tr>
      <td>n &gt;&amp; m</td>
      <td style="text-align: left">将输出文件 m 和 n 合并。</td>
    </tr>
    <tr>
      <td>n &lt;&amp; m</td>
      <td style="text-align: left">将输入文件 m 和 n 合并。</td>
    </tr>
    <tr>
      <td>« tag</td>
      <td style="text-align: left">将开始标记 tag 和结束标记 tag 之间的内容作为输入。</td>
    </tr>
  </tbody>
</table>

<!-- more -->

<ul>
  <li><strong>需要注意的是文件描述符 0 通常是标准输入（STDIN），1 是标准输出（STDOUT），2 是标准错误输出（STDERR）。</strong></li>
</ul>

<hr />
<h5 id="11输出重定向"><strong>1.1、输出重定向</strong></h5>
<p>重定向一般通过在命令间插入特定的符号来实现，语法如下：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>command1 &gt; file1
</code></pre></div></div>

<p>上面这个命令执行command1然后将输出的内容存入file1。</p>

<p>注意任何file1内的已经存在的内容将被新内容替代。如果要将新的内容添加到文件的末尾，则使用»操作符。</p>

<p><strong>例子</strong>：</p>

<p>我们先新建一个文件test2，然后执行 ls -al 重定向到test2文件中，在命令行的操作符代码如下：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#新建test2文件
touch test2    
#输出重定向
ls -al &gt; test2

</code></pre></div></div>

<p>然后我们使用cat命令查看文件内容：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@iZ28t5k4ny4Z:/usr/xiho/shell# cat test3
total 132
drwxr-xr-x 2 root root  4096 Oct  1 13:19 .
drwxr-xr-x 4 root root  4096 Sep 27 16:29 ..
-rw-r--r-- 1 root root 12288 Sep 27 19:15 .01.sh.swo
-rw-r--r-- 1 root root 12288 Sep 27 16:35 .01.sh.swp
-rwxr--r-- 1 root root   347 Sep 28 21:07 02.sh
-rwxr--r-- 1 root root   100 Sep 28 21:28 03.sh
-rw-r--r-- 1 root root 12288 Sep 28 21:15 .03.sh.swp
-rwxr--r-- 1 root root   109 Sep 28 22:17 04.sh
-rw------- 1 root root 12288 Sep 30 18:03 .04.swp
-rw-r--r-- 1 root root     0 Sep 28 22:45 05.sh
-rw-r--r-- 1 root root 12288 Sep 28 22:47 .05.sh.swp
-rw-r--r-- 1 root root     0 Sep 30 20:57 06.sh
-rw-r--r-- 1 root root 12288 Sep 30 21:00 .06.sh.swp
-rwxrwxrwx 1 root root   223 Sep 30 17:50 b.sh
-rw-r--r-- 1 root root 12288 Sep 30 18:03 .b.sh.swo
-rw-r--r-- 1 root root 12288 Sep 28 16:50 .b.sh.swp
-rwxrwxrwx 1 root root   119 Oct  1 13:12 demo.sh
-rwxr--r-- 1 root root    68 Sep 30 14:09 test1.sh
-rw-r--r-- 1 root root   954 Oct  1 13:10 test2
-rw-r--r-- 1 root root     0 Oct  1 13:19 test3

</code></pre></div></div>

<p>就会把当前目录下的所有文件给显示出来了。</p>

<p>如果不希望文件内容被覆盖，可以使用 » 追加到文件末尾，这个请自行练习使用。</p>

<hr />

<h5 id="12输入重定向"><strong>1.2、输入重定向</strong></h5>
<p>和输出重定向一样，Unix 命令也可以从文件获取输入，语法为：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>command1 &lt; file1
</code></pre></div></div>

<p>这样，本来需要从键盘获取输入的命令会转移到文件读取内容。注意：输出重定向是大于号（&gt;），出入重定向是小于号（&lt;）。</p>

<p><strong>例子</strong></p>

<p>接着上面的例子，我们统计test2文件的行数，(不熟悉命令的同学，请查看我的 <a href="http://blog.csdn.net/u011974987/article/details/52703177">shell命令（二）</a>的文章），执行以下命令：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> wc -l test2
 21 test2
</code></pre></div></div>
<p>也可以将输入重定向到test2文件中：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>wc -l &lt; test2
21
</code></pre></div></div>

<p><strong>注意：</strong>上面两个例子的结果不同；第一个例子，会输出文件名；第二不会，因为它仅仅知道从标准输入读取内容。</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> command1 &lt; infile &gt; outfile
</code></pre></div></div>

<p>同时替换输入和输出，执行command1，从文件infile读取内容，然后将输出写入到outfile中。</p>

<hr />
<h5 id="13重定向深入理解"><strong>1.3、重定向深入理解</strong></h5>

<p>一般情况下，每一个Linux 命令运行时都会打开三个文件：</p>

<ul>
  <li>标准输入文件（stdin）: stdin的文件描述符为0，linux程序默认从stdin读取数据。</li>
  <li>标准输出文件（stdout）: stdout 的文件描述为1，linux程序默认想stdout输出数据。</li>
  <li>标准错误文件（stderr）: stderr 的文件描述符为2，linux程序会想stderr流中写入错误信息。</li>
</ul>

<hr />
<p>以后打开文件后。新增文件绑定描述符 可以依次增加。 一条shell命令执行，都会继承父进程的文件描述符。因此，所有运行的shell命令，都会有默认3个文件描述符。</p>

<p>正常情况下，command &gt; file 将stdout重定向file，command &lt; file 将stdin 重定向到 file。</p>

<p>一个命令执行了：
先有一个输入：输入可以从键盘，也可以从文件得到
命令执行完成：成功了，会把成功结果输出到屏幕：standard output默认是屏幕
命令执行有错误：会把错误也输出到屏幕上面：standard error默认也是指的屏幕</p>

<p>如果希望stderr 重定向 到file 可以这样写：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>command 2&gt; file
</code></pre></div></div>

<p>如果希望stderr追加到file 文件末尾，可以这样写：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>command 2&gt;&gt; file
</code></pre></div></div>

<ul>
  <li><strong>实例（通俗易懂）</strong></li>
</ul>

<p>显示当前目录文件，写一个实际存在和一个不存在的，方便理解。比如当前目录存在test1.sh，不存在xiho。代码如下：</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@iZ28t5k4ny4Z:/usr/xiho/shell# ls test1.sh xiho 
ls: cannot access xiho: No such file or directory
test1.sh
</code></pre></div></div>

<p>看到上面代码显示在屏幕上面，找不到文件路劲报错，正确输出与错误输出都显示在屏幕了，<strong>但是现在需要把正确输出写入suc.txt， 1&gt; 可以省略，不写，默认所至标准输出，把错误输出到err.txt，不输出到屏幕。</strong></p>

<p>例子如下：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ls test1.sh xiho 1&gt; suc.txt 2&gt;err.txt

</code></pre></div></div>
<p>然后我们分别查看suc.txt和err .txt的信息。</p>

<p><img src="https://img-blog.csdn.net/20161001150059408" alt="这里写图片描述" /></p>

<p>将错误输出信息关闭掉</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@iZ28t5k4ny4Z:/usr/xiho/shell# ls test1.sh xiho 2&gt;&amp;-
test1.sh
root@iZ28t5k4ny4Z:/usr/xiho/shell# ls test1.sh xiho 2&gt;/dev/null
test1.sh

&amp;[n] 代表是已经存在的文件描述符，&amp;1 代表输出 &amp;2代表错误输出 &amp;-代表关闭与它绑定的描述符
/dev/null 这个设备，是linux 中黑洞设备，什么信息只要输出给这个设备，都会给吃掉，哈哈~
</code></pre></div></div>
<p>其他的追加操作符等，好玩的自己去试试。</p>

<p><strong>注意：</strong>
1、shell遇到”&gt;”操作符，会判断右边文件是否存在，如果存在就先删除，并且创建新文件。不存在直接创建。 无论左边命令执行是否成功。右边文件都会变为空。
2、“»”操作符，判断右边文件，如果不存在，先创建。以添加方式打开文件，会分配一个文件描述符[不特别指定，默认为1,2]然后，与左边的标准输出（1）或错误输出（2） 绑定。
3、当命令：执行完，绑定文件的描述符也自动失效。0,1,2又会空闲。
4、一条命令启动，命令的输入，正确输出，错误输出，默认分别绑定0,1,2文件描述符。
5、一条命令在执行前，先会检查输出是否正确，如果输出设备错误，将不会进行命令执行。</p>

<hr />

<h4 id="2here-document"><strong>2、Here Document</strong></h4>

<p>Here Document是shell 中的一种特殊重定向方式，用来将输入重定向到一个交互式的shell脚本或程序。</p>

<p>基本的格式如下：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>command &lt;&lt; EOF
	document
EOF
</code></pre></div></div>

<p>它的作用是将两个EOF之间的内容（docuemnt）作为输入传递给command。</p>

<blockquote>
  <p>注意：</p>
  <ul>
    <li>结尾的EOF一定要顶个写，前面不能有任何字符，后面也不能有任何字符，包括空格和tab缩进。</li>
    <li>开始的EOF前后的空格不要被忽略掉。</li>
  </ul>
</blockquote>

<ul>
  <li><strong>实例</strong></li>
</ul>

<p>在命令行中通过wc -l 命令计算Here Document 的行数：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@iZ28t5k4ny4Z:/usr/xiho/shell# wc -l &lt;&lt; EOF
&gt; 学习使用shell 编程
&gt; www.xuhaoblog.com
&gt; EOF
2
</code></pre></div></div>
<p>输出的结果为2行。</p>

<p>我们也可以将Here Document 用在脚本中，例如：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1 #!/bin/bash                                                            
  2 cat &lt;&lt; EOF
  3 学习使用shell脚本编程
  4 www.xuhaoblog.com
  5 EOF

</code></pre></div></div>
<p>执行以上脚本输出的结果：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@iZ28t5k4ny4Z:/usr/xiho/shell# chmod u+x 05.sh 
root@iZ28t5k4ny4Z:/usr/xiho/shell# ./05.sh
学习使用shell脚本编程
www.xuhaoblog.com
</code></pre></div></div>

<p>Here Document 的简单使用就到这里，还有更多的操作符需要我们去练习。Linux shell脚本基础学习，我们差不多介绍完了，还有一个关于函数的，准备放到下一篇来讲。欢迎关注~</p>

<hr />
<h3 id="更多相关系列传送门">更多相关系列传送门：</h3>
<p><strong>【个人博客】shel 脚本系列</strong></p>

<ul>
  <li><a href="http://xuhaoblog.com/linux/shell-script-01.html">【Linux 系统编程】shell 脚本基础学习（一）</a></li>
  <li><a href="http://xuhaoblog.com/linux/shell-script-02.html">【Linux 系统编程】shell 命令和流程控制（二）</a></li>
  <li><a href="http://xuhaoblog.com/linux/shell-script-03.html">【Linux 系统编程】shell 流程控制loop和引号（三）</a></li>
  <li><a href="http://xuhaoblog.com/linux/shell-script-04.html">【Linux 系统编程】shell 输入/输出重定向（四）</a></li>
  <li><a href="http://xuhaoblog.com/linux/shell-script-05.html">【Linux 系统编程】shell 脚本基础学习之函数（五）</a></li>
</ul>


        </article>
        <hr>

        
        
            
            
                
                    
                
            
                
                    
                
            
        
            
            
                
                    
                
            
        
            
            
                
                    
                
            
        
            
            
                
                    
                
            
        
            
            
                
                    
                
            
        
            
            
                
                    
                
            
        
            
            
                
                    
                
            
        
            
            
                
                    
                
            
        
            
            
                
                    
                        
                        <h2 id="similar_posts">Similar Posts</h2>
                        <ul>
                        
                        <li class="relatedPost">
                            <a href="/linux/shell-script-05">shell 脚本基础学习之函数（五）
                            
                            </a>
                        </li>
                        
                        
                    
                
            
        
            
            
                
                    
                        
                        <li class="relatedPost">
                            <a href="/linux/shell-script-03">shell 流程控制loop和引号（三）
                            
                            </a>
                        </li>
                        
                        
                    
                
            
        
        
            </ul>
        

        <div class="post-recent">
    <div class="pre">
        
        <p><strong>上一篇</strong> <a href="/linux/shell-script-03">shell 流程控制loop和引号（三）</a></p>
        
    </div>
    <div class="nex">

        
        <p><strong>下一篇</strong> <a href="/linux/shell-script-05">shell 脚本基础学习之函数（五）</a></p>
        
    </div>
</div>


        <h2 id="comments">Comments</h2>
        
  
  <!-- Gitalk 评论 start  -->
  <!-- Link Gitalk 的支持文件  -->
  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
  <script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>
  
  <div id="gitalk-container">
      <script type="text/javascript">
      var gitalk = new Gitalk({
  
      // gitalk的主要参数
          clientID: `3d507f3b58e98bd4c002`,
          clientSecret: `20eb5562ff08dcc12a9a61edbdb8b29f9135e302`,
          repo: `git-xuhao.github.io`,
          owner: `git-xuhao`,
          admin: [`git-xuhao`],
          id: location.pathname,
          distractionFreeMode: false

      });
      gitalk.render('gitalk-container');
  </script>
  </div>
  <!-- Gitalk end -->



    </div>
    <button class="anchor"><i class="fa fa-anchor"></i></button>
    <div class="right">
        <div class="wrap">

            <!-- Content -->
            <div class="side content">
                <div>
                    目录
                </div>
                <ul id="content-side" class="content-ul">
                    
                    <li><a href="#similar_posts">Similar Posts</a></li>
                    
                    <li><a href="#comments">Comments</a></li>
                </ul>
            </div>
            <!-- 其他div框放到这里 -->
            <!-- <div class="side">bbbb</div> -->
        </div>
    </div>
</div>
<script>
/**
 * target _blank
 */
(function() {
    var aTags = document.querySelectorAll('article a:not([id])')
    for (var i = 0; i < aTags.length; i++) {
        aTags[i].setAttribute('target', '_blank')
    }
}());
</script>
<script src="/js/pageContent.js " charset="utf-8"></script>


    <footer class="site-footer">


    <div class="wrapper">

        <p class="description">
             徐昊Xiho开源技术博客 
        </p>
        <p class="contact">
            <b>| 联系我</b>
            <a href="mailto:igeekho@gmail.com" title="email"><i class="fa fa-envelope-square" aria-hidden="true"></i></a> 
            <a href="https://github.com/git-xuhao" title="GitHub"><i class="fa fa-github" aria-hidden="true"></i></a> 
            <a href="http://weibo.com/xuxiho" title="Weibo"><i class="fa fa-weibo" aria-hidden="true"></i></a>    
            <a href="https://www.facebook.com/google.xu" title="Facebook"><i class="fa fa-facebook-official" aria-hidden="true"></i></a>    
        </p>
        <p>
            本站总访问量<span id="busuanzi_value_site_pv"></span>次，本站访客数<span id="busuanzi_value_site_uv"></span>人次
        </p>
      
            <span>
                © 2015-2018  Power by Jekyll </a>
            </span>
    
    </div>
</footer>
<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

    <div class="back-to-top">
    <a href="#top" data-scroll>
        <i class="fa fa-arrow-up" aria-hidden="true"></i>
    </a>
</div>

    <script src=" /js/main.js " charset="utf-8"></script>
    <script src=" /js/smooth-scroll.min.js " charset="utf-8"></script>
    <script type="text/javascript">
      smoothScroll.init({
        speed: 500, // Integer. How fast to complete the scroll in milliseconds
        easing: 'easeInOutCubic', // Easing pattern to use
        offset: 20, // Integer. How far to offset the scrolling anchor location in pixels
      });
    </script>
    <!-- <script src=" /js/scroll.min.js " charset="utf-8"></script> -->
  </body>

</html>
