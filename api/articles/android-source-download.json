{"title":"Ubuntu 15.10 下载Android5.1代码环境搭建","slug":"android-source-download","date":"2016-04-10T02:05:36.000Z","updated":"2017-12-17T16:14:16.000Z","comments":true,"path":"api/articles/android-source-download.json","photos":[],"link":"","excerpt":"概述：作为一个Android开发者，想要自己提升一个阶段，想深入了解 Android 相关的知识，Activity 是工作流程是怎样的？ View 是怎样绘制的？ 怎样修改一些系统相关的应用？等等，就得要深入Android 源代码~所以就要先获取Android源码：准备工作：装一个Ubuntu系统（http://www.ubuntu.com/download/desktop）电脑的内存最好有 8 G，因为编译 Android 源码很吃电脑内存，特别是在 4.4 以后的版本，电脑内存大点，比较保险，编译一次源码要好几个小时，要因为内存原因，太让人郁闷了。<br>ps:( ubuntu装完后把系统软件全都更新一下)一个翻墙vpn（https://www.trueyt.com/）","covers":["http://img.blog.csdn.net/20160325114724525"],"content":"<h2 id=\"概述：\"><a href=\"#概述：\" class=\"headerlink\" title=\"概述：\"></a><strong>概述：</strong></h2><p>作为一个Android开发者，想要自己提升一个阶段，想深入了解 Android 相关的知识，Activity 是工作流程是怎样的？ View 是怎样绘制的？ 怎样修改一些系统相关的应用？等等，就得要深入Android 源代码~所以就要先获取Android源码：</p>\n<h3 id=\"准备工作：\"><a href=\"#准备工作：\" class=\"headerlink\" title=\"准备工作：\"></a>准备工作：</h3><ol>\n<li>装一个Ubuntu系统（<a href=\"http://www.ubuntu.com/download/desktop）电脑的内存最好有\" target=\"_blank\" rel=\"noopener\">http://www.ubuntu.com/download/desktop）电脑的内存最好有</a> 8 G，因为编译 Android 源码很吃电脑内存，特别是在 4.4 以后的版本，电脑内存大点，比较保险，编译一次源码要好几个小时，要因为内存原因，太让人郁闷了。<br>ps:( ubuntu装完后把系统软件全都更新一下)</li>\n<li><p>一个翻墙vpn（<a href=\"https://www.trueyt.com/）\" target=\"_blank\" rel=\"noopener\">https://www.trueyt.com/）</a></p>\n<a id=\"more\"></a>\n</li>\n</ol>\n<h3 id=\"编译环境的部署：\"><a href=\"#编译环境的部署：\" class=\"headerlink\" title=\"编译环境的部署：\"></a>编译环境的部署：</h3><p>   访问： <a href=\"http://source.android.com/source/initializing.html\" target=\"_blank\" rel=\"noopener\">http://source.android.com/source/initializing.html</a></p>\n<h2 id=\"1、-Installing-the-JDK\"><a href=\"#1、-Installing-the-JDK\" class=\"headerlink\" title=\"1、 Installing the JDK\"></a><strong>1、 Installing the JDK</strong></h2><p>Android 5.0 编译需要 Open Java7 版本<br><figure class=\"highlight routeros\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ sudo apt-<span class=\"builtin-name\">get</span> update</span><br><span class=\"line\">$ sudo apt-<span class=\"builtin-name\">get</span> install openjdk-7-jdk</span><br></pre></td></tr></table></figure></p>\n<p>Android 4.4 编译需要 Sun Java6 版本</p>\n<figure class=\"highlight smali\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ sudo<span class=\"built_in\"> add-apt-repository </span>ppa:webupd8team/java</span><br><span class=\"line\">$ sudo apt-get update</span><br><span class=\"line\">$ sudo apt-get install oracle-java6-set-default</span><br></pre></td></tr></table></figure>\n<p>切换 Java 的方法 (上面 2 个根据你的需要安装)</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> sudo update-alternatives --config java</span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> sudo update-alternatives --config javac</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"2、-Installing-required-packages\"><a href=\"#2、-Installing-required-packages\" class=\"headerlink\" title=\"2、   Installing required packages\"></a><strong>2、   Installing required packages</strong></h2><figure class=\"highlight vim\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ sudo apt-<span class=\"built_in\">get</span> install bison g++-multilib git gperf libxml2-utils <span class=\"keyword\">make</span> <span class=\"keyword\">python</span>-networkx zlib1g-de<span class=\"variable\">v:i386</span> zip</span><br><span class=\"line\">$ sudo apt-<span class=\"built_in\">get</span> install git gnupg flex bison gperf build-essential zip curl libc6-dev libncurses5-de<span class=\"variable\">v:i386</span> x11proto-core-dev libx11-de<span class=\"variable\">v:i386</span> libreadline6-de<span class=\"variable\">v:i386</span> libgl1-mesa-glx:i386 libgl1-mesa-dev g++-multilib mingw32 tofrodos <span class=\"keyword\">python</span>-markdown libxml2-utils xsltproc zlib1g-de<span class=\"variable\">v:i386</span></span><br><span class=\"line\">$ sudo <span class=\"keyword\">ln</span> -s /usr/lib/i386-linux-gnu/mesa/libGL.<span class=\"keyword\">so</span>.<span class=\"number\">1</span> /usr/lib/i386-linux-gnu/libGL.<span class=\"keyword\">so</span></span><br></pre></td></tr></table></figure>\n<p><strong> Notes！！不同的 Ubuntu 版本可能不能，安装这些编译工具可能不成功，也不用管，在你编译的时候，可能会出错，根据错误日志去解决就行了。</strong></p>\n<p>配置 USB 访问 (下面的都可能需要翻墙了)</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> wget -S -O - http://source.android.com/<span class=\"built_in\">source</span>/51-android.rules | sed <span class=\"string\">\"s/&lt;username&gt;/<span class=\"variable\">$USER</span>/\"</span> |sudo tee &gt;/dev/null /etc/udev/rules.d/51-android.rules; </span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> sudo udevadm control --reload-rules</span></span><br></pre></td></tr></table></figure>\n<p>安装 repo ， repo 是 git 的管理工具</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> mkdir ~/bin</span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> PATH=~/bin:<span class=\"variable\">$PATH</span></span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> curl https://storage.googleapis.com/git-repo-downloads/repo &gt; ~/bin/repo</span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> chmod a+x ~/bin/repo</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"下载源代码\"><a href=\"#下载源代码\" class=\"headerlink\" title=\"下载源代码\"></a>下载源代码</h3><p>（我这边添加的是内置服务器，从我们自己的服务器下载的代码很快，一般一个小时左右就下载完了！）</p>\n<ul>\n<li>建立一个目录来存放 Android 源码</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> mkdir android_source_5.0</span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> <span class=\"built_in\">cd</span> android_source_5.0</span></span><br></pre></td></tr></table></figure>\n<ul>\n<li>初始化下载</li>\n</ul>\n<figure class=\"highlight armasm\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ repo init -u https://<span class=\"keyword\">android.googlesource.com/platform/manifest </span>-<span class=\"keyword\">b </span></span><br><span class=\"line\">你要同步的源码(<span class=\"keyword\">android-5.0.1_r1)</span></span><br></pre></td></tr></table></figure>\n<ul>\n<li>在初始化时，可能要配置下git的emai 信息：</li>\n</ul>\n<figure class=\"highlight routeros\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ git<span class=\"built_in\"> config </span>--global user.email <span class=\"string\">\"you@example.com\"</span></span><br><span class=\"line\">$ git<span class=\"built_in\"> config </span>--global user.name <span class=\"string\">\"Your Name\"</span></span><br></pre></td></tr></table></figure>\n<ul>\n<li>Downloading the Android Source Tree同步源码</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> repo sync</span></span><br></pre></td></tr></table></figure>\n<p>这个命令如果代理断了需要重新执行这个命令同步代码(也可以写一个shell 脚本)</p>\n<p>当控制台显示 successful的时候恭喜你代码同步成功了~控制台显示如下：</p>\n<h3 id=\"编译源代码\"><a href=\"#编译源代码\" class=\"headerlink\" title=\"编译源代码\"></a>编译源代码</h3><p>进入到你DownLoad 源码的目录下，执行以下命令</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> <span class=\"built_in\">cd</span> android_source_5.0</span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> <span class=\"built_in\">source</span> build/envsetup.sh</span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> choosecombo release aosp_flo eng</span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> make -j4</span></span><br></pre></td></tr></table></figure>\n<p>编译的时间是漫长的，中间还可能出错，所以我们需要随时陪同，中间还可能需要解错，当你看见屏幕的最下面出现 Successful 的时候，恭喜你，源码已经编译成功。如下图：<br><img src=\"http://img.blog.csdn.net/20160325114724525\" alt=\"这里写图片描述\"></p>\n<blockquote>\n<p>转载请注明出处：<a href=\"http://blog.csdn.net/u011974987/article/details/50978291\" target=\"_blank\" rel=\"noopener\">http://blog.csdn.net/u011974987/article/details/50978291</a></p>\n</blockquote>\n","categories":[{"name":"Ubuntu","slug":"Ubuntu","count":2,"path":"api/categories/Ubuntu.json"}],"tags":[{"name":"Ubuntu","slug":"Ubuntu","count":2,"path":"api/tags/Ubuntu.json"},{"name":"AOSP","slug":"AOSP","count":1,"path":"api/tags/AOSP.json"}]}